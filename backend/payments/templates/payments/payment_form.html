{% extends "base.html" %}
{% load static %}

{% block title %}{% if payment %}Edit Payment{% else %}Create Payment{% endif %}{% endblock %}

{% block content %}
<div class="payment-form">
    <h1>{% if payment %}Edit Payment{% else %}Create New Payment{% endif %}</h1>

    <form method="post" class="payment-form-content">
        {% csrf_token %}

        <div class="form-group">
            <label for="customer">Customer *</label>
            <select name="customer" id="customer" required>
                <option value="">Select a customer</option>
                {% for customer in customers %}
                <option value="{{ customer.id }}" {% if payment.customer.id == customer.id %}selected{% endif %}>
                    {{ customer.name }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="payment_type">Payment Type *</label>
            <select name="payment_type" id="payment_type" required>
                <option value="">Select payment type</option>
                {% for pt in payment_types %}
                <option value="{{ pt.id }}" {% if payment.payment_type.id == pt.id %}selected{% endif %}>
                    {{ pt.name }} ({{ pt.get_mode_display }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="amount">Amount *</label>
                <input type="number" name="amount" id="amount" step="0.01" min="0"
                       value="{{ payment.amount|default:'' }}" required>
            </div>

            <div class="form-group">
                <label for="payment_method">Payment Method *</label>
                <select name="payment_method" id="payment_method" required>
                    <option value="">Select method</option>
                    <option value="cash" {% if payment.payment_method == 'cash' %}selected{% endif %}>Cash</option>
                    <option value="bank_transfer" {% if payment.payment_method == 'bank_transfer' %}selected{% endif %}>Bank Transfer</option>
                    <option value="check" {% if payment.payment_method == 'check' %}selected{% endif %}>Check</option>
                    <option value="credit_card" {% if payment.payment_method == 'credit_card' %}selected{% endif %}>Credit Card</option>
                    <option value="mobile_money" {% if payment.payment_method == 'mobile_money' %}selected{% endif %}>Mobile Money</option>
                    <option value="other" {% if payment.payment_method == 'other' %}selected{% endif %}>Other</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="payment_date">Payment Date *</label>
                <input type="date" name="payment_date" id="payment_date"
                       value="{{ payment.payment_date|date:'Y-m-d'|default:'' }}" required>
            </div>

            <div class="form-group">
                <label for="status">Status</label>
                <select name="status" id="status">
                    <option value="completed" {% if payment.status == 'completed' %}selected{% endif %}>Completed</option>
                    <option value="pending" {% if payment.status == 'pending' %}selected{% endif %}>Pending</option>
                    <option value="cancelled" {% if payment.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
                    <option value="refunded" {% if payment.status == 'refunded' %}selected{% endif %}>Refunded</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="reference_number">Reference Number</label>
            <input type="text" name="reference_number" id="reference_number"
                   value="{{ payment.reference_number|default:'' }}"
                   placeholder="Check number, transaction ID, etc.">
        </div>

        <div class="form-group">
            <label for="notes">Notes</label>
            <textarea name="notes" id="notes" rows="4"
                      placeholder="Additional notes about this payment">{{ payment.notes|default:'' }}</textarea>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary">
                {% if payment %}Update Payment{% else %}Create Payment{% endif %}
            </button>
            <a href="{% url 'payments:payment_list' %}" class="btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<style>
.payment-form {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

.payment-form-content {
    background: #f8f9fa;
    padding: 30px;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.form-group {
    margin-bottom: 20px;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #495057;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    font-size: 14px;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
}

.form-actions {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #dee2e6;
}

.btn-primary {
    background-color: #007bff;
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    text-decoration: none;
    display: inline-block;
}

.btn-primary:hover {
    background-color: #0056b3;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    text-decoration: none;
    display: inline-block;
}

.btn-secondary:hover {
    background-color: #545b62;
    color: white;
    text-decoration: none;
}
</style>
{% endblock %}
